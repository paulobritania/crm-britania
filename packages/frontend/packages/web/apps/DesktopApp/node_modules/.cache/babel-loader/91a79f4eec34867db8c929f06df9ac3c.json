{"ast":null,"code":"var _jsxFileName = \"/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/customers/screens/CustomerPreRegistrationFormScreen/CustomerPreRegistrationFormScreen.js\";\nimport React, { useState, useMemo, useRef, useEffect, useCallback } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport moment from 'moment/moment';\nimport isEmpty from 'lodash/isEmpty';\nimport Grid from '@material-ui/core/Grid';\nimport Tab from '@material-ui/core/Tab';\nimport { useDialog } from '@britania-crm/dialog';\nimport { useFormEffect } from '@britania-crm/forms';\nimport customerPreRegistrationSchema, { INITIAL_VALUES } from '@britania-crm/forms/schemas/customer/customerPreRegistration.schema';\nimport I18n, { useT } from '@britania-crm/i18n';\nimport { customer as customerCrmRoutes, documents as documentsCrmRoutes } from '@britania-crm/services/apis/crmApi/resources/routes';\nimport useCrmApi from '@britania-crm/services/hooks/useCrmApi';\nimport { AppActions } from '@britania-crm/stores/app';\nimport { CustomerActions } from '@britania-crm/stores/customer';\nimport defaultFile from '@britania-crm/styles/assets/images/default_login_bg.png';\nimport { formatBackDateToIsoFormat, formatBackDateTimeToBackDateFormat, dateBackFormat } from '@britania-crm/utils/date';\nimport { trimMask } from '@britania-crm/utils/formatters';\nimport Button from '@britania-crm/web-components/Button';\nimport Form from '@britania-crm/web-components/Form';\nimport { CircularLoader } from '@britania-crm/web-components/Loader';\nimport ConfirmModal from '@britania-crm/web-components/Modal/ConfirmModal';\nimport Tabs from '@britania-crm/web-components/Tabs';\nimport { useRoutes } from '@britania-crm/web-src/routes/authenticated.routes';\nimport DocumentationCustomerModal from '../../modals/DocumentationCustomerModal';\nimport { getPayloadFiscalParametrizationCfop, getFormFiscalParametrizationCfop } from '../../utils';\nimport useStyles from './styles';\nimport Customer from './tabs/Customer/Customer';\nimport Documents from './tabs/Documents/Documents';\nimport Fiscal from './tabs/Fiscal/Fiscal';\nimport RegistrationParameters from './tabs/RegistrationParameters/RegistrationParameters';\n\nconst CustomerPreRegistrationFormScreen = () => {\n  const t = useT();\n  const classes = useStyles();\n  const history = useHistory();\n  const dispatch = useDispatch();\n  const {\n    routes,\n    currentRoute\n  } = useRoutes();\n  const {\n    state\n  } = useLocation();\n  const {\n    createDialog\n  } = useDialog();\n  const formRef = useRef(null);\n  const [saveLoader, setSaveLoader] = useState(false);\n  const [concludeLoader, setConcludeLoader] = useState(false);\n  const [statusCustomer, setStatusCustomer] = useState('');\n  const customerId = useMemo(() => {\n    var _state$params;\n\n    return state === null || state === void 0 ? void 0 : (_state$params = state.params) === null || _state$params === void 0 ? void 0 : _state$params.id;\n  }, [state]);\n  const {\n    data: customerFromApi,\n    loading: getLoading\n  } = useCrmApi(customerId ? [customerCrmRoutes.getOnePreRegister.replace(':id', customerId), state] : null, null, {\n    onErrorRetry(error, key, config, revalidate, {\n      retryCount\n    }) {\n      var _error$response;\n\n      if ((error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 500 && retryCount < 5) {\n        createDialog({\n          id: 'new-request-modal',\n          Component: ConfirmModal,\n          props: {\n            onConfirm() {\n              revalidate({\n                retryCount\n              });\n            },\n\n            onNegative() {\n              history.goBack();\n            },\n\n            text: t('search error customer')\n          }\n        });\n      } else {\n        dispatch(AppActions.addAlert({\n          type: 'error',\n          message: t('maximum number of attempts reached')\n        }));\n        history.goBack();\n      }\n    },\n\n    revalidateOnFocus: false\n  });\n  const {\n    data: documentFromApi\n  } = useCrmApi([`${documentsCrmRoutes.getOne}/PRE_CAD_CLIENTE_DOCUMENTACAO`]);\n  const imagePreview = useMemo(() => {\n    if (!isEmpty(documentFromApi)) {\n      return { ...documentFromApi.file,\n        type: documentFromApi.file.contentType\n      };\n    }\n\n    return defaultFile;\n  }, [documentFromApi]);\n  const loading = useMemo(() => getLoading || saveLoader || concludeLoader, [concludeLoader, getLoading, saveLoader]);\n  const mode = useMemo(() => {\n    var _routes$newCustomerPr, _routes$editCustomerP;\n\n    switch (currentRoute.path) {\n      case (_routes$newCustomerPr = routes.newCustomerPreRegistration) === null || _routes$newCustomerPr === void 0 ? void 0 : _routes$newCustomerPr.path:\n        return 'create';\n\n      case (_routes$editCustomerP = routes.editCustomerPreRegistration) === null || _routes$editCustomerP === void 0 ? void 0 : _routes$editCustomerP.path:\n        return 'edit';\n\n      default:\n        return 'view';\n    }\n  }, [currentRoute.path, routes]);\n  const disabled = useMemo(() => mode === 'view', [mode]);\n  const tabs = useMemo(() => [/*#__PURE__*/React.createElement(Tab, {\n    key: 1,\n    label: t('registration parameters'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Tab, {\n    key: 2,\n    label: t('customer', {\n      howMany: 1\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Tab, {\n    key: 3,\n    label: t('documents'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Tab, {\n    key: 4,\n    label: t('fiscal parameterization'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 7\n    }\n  })], [t]);\n  const handleDocumentation = useCallback(() => createDialog({\n    id: 'new-user-modal',\n    Component: DocumentationCustomerModal,\n    props: {\n      imagePreview\n    }\n  }), [createDialog, imagePreview]);\n  const tabsContent = useMemo(() => [/*#__PURE__*/React.createElement(RegistrationParameters, {\n    key: 1,\n    formRef: formRef,\n    disabled: disabled,\n    handleDocumentation: handleDocumentation,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Customer, {\n    key: 2,\n    formRef: formRef,\n    disabled: disabled,\n    status: statusCustomer,\n    isEdit: mode === 'edit',\n    handleDocumentation: handleDocumentation,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Documents, {\n    key: 3,\n    formRef: formRef,\n    disabled: disabled,\n    handleDocumentation: handleDocumentation,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Fiscal, {\n    key: 4,\n    formRef: formRef,\n    disabled: disabled,\n    handleDocumentation: handleDocumentation,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 7\n    }\n  })], [disabled, handleDocumentation, mode, statusCustomer]);\n  const formatPayload = useCallback(values => {\n    var _values$parentCompany, _values$additionalInf, _values$additionalInf2, _values$additionalInf3, _values$additionalInf4, _values$additionalInf5, _values$additionalInf6, _values$financial, _values$financial2, _values$financial3, _values$financial4, _values$financial5, _values$financial6, _values$financial7, _values$financial8, _values$financial9, _values$financial10, _values$financial11, _values$financial12, _values$financial13, _values$financial14, _values$financial15, _values$cadastralChec, _values$cadastralChec2, _values$cadastralChec3, _values$parametrizati, _values$parametrizati2, _values$parametrizati3, _values$parametrizati4, _values$parametrizati5, _values$parametrizati6, _values$parametrizati7, _values$priceList, _values$priceList$est, _values$priceList2, _values$priceList2$es, _values$priceList3, _values$priceList3$es, _values$priceList4, _values$priceList4$es, _values$priceList5, _values$priceList5$es, _values$priceList6, _values$priceList6$es, _values$priceList7, _values$priceList7$es, _values$responsibleCo, _values$responsibleNa, _values$fiscalParamet, _values$fiscalParamet2;\n\n    return { ...values,\n      id: customerFromApi === null || customerFromApi === void 0 ? void 0 : customerFromApi.id,\n      cnpj: trimMask(values.cnpj || ''),\n      parentCompanyCnpj: trimMask(values.parentCompanyCnpj || ''),\n      commercialPhone: trimMask(values.commercialPhone || ''),\n      billingPhone: trimMask(values.billingPhone || ''),\n      cellphone: trimMask(values.cellphone || ''),\n      shoppingPhone: trimMask(values.shoppingPhone || ''),\n      stateRegistration: trimMask(values.stateRegistration || ''),\n      number: values.number || '',\n      fiscalParametrizationCfop: getPayloadFiscalParametrizationCfop(values),\n      parentCompanyName: ((_values$parentCompany = values.parentCompanyName) === null || _values$parentCompany === void 0 ? void 0 : _values$parentCompany.companyName) || '',\n      additionalInformation: { ...(values.additionalInformation || {}),\n        counter: { ...(((_values$additionalInf = values.additionalInformation) === null || _values$additionalInf === void 0 ? void 0 : _values$additionalInf.counter) || {}),\n          counterPhone: trimMask((values === null || values === void 0 ? void 0 : (_values$additionalInf2 = values.additionalInformation) === null || _values$additionalInf2 === void 0 ? void 0 : (_values$additionalInf3 = _values$additionalInf2.counter) === null || _values$additionalInf3 === void 0 ? void 0 : _values$additionalInf3.counterPhone) || '')\n        },\n        numbersOfEmployes: ((_values$additionalInf4 = values.additionalInformation) === null || _values$additionalInf4 === void 0 ? void 0 : _values$additionalInf4.numbersOfEmployes) ? Number(values.additionalInformation.numbersOfEmployes) : null,\n        suggestedLimit: ((_values$additionalInf5 = values.additionalInformation) === null || _values$additionalInf5 === void 0 ? void 0 : _values$additionalInf5.suggestedLimit) ? Number(values.additionalInformation.suggestedLimit) : null,\n        shareCapital: ((_values$additionalInf6 = values.additionalInformation) === null || _values$additionalInf6 === void 0 ? void 0 : _values$additionalInf6.shareCapital) ? Number(values.additionalInformation.shareCapital) : null\n      },\n      financial: {\n        issueBankSlip: ((_values$financial = values.financial) === null || _values$financial === void 0 ? void 0 : _values$financial.issueBankSlip) !== undefined ? !!((_values$financial2 = values.financial) === null || _values$financial2 === void 0 ? void 0 : _values$financial2.issueBankSlip) : null,\n        gerenatesDebitNotice: ((_values$financial3 = values.financial) === null || _values$financial3 === void 0 ? void 0 : _values$financial3.gerenatesDebitNotice) !== undefined ? !!((_values$financial4 = values.financial) === null || _values$financial4 === void 0 ? void 0 : _values$financial4.gerenatesDebitNotice) : null,\n        calculatesFine: ((_values$financial5 = values.financial) === null || _values$financial5 === void 0 ? void 0 : _values$financial5.calculatesFine) !== undefined ? !!((_values$financial6 = values.financial) === null || _values$financial6 === void 0 ? void 0 : _values$financial6.calculatesFine) : null,\n        receives_nfe: ((_values$financial7 = values.financial) === null || _values$financial7 === void 0 ? void 0 : _values$financial7.receives_nfe) !== undefined ? !!((_values$financial8 = values.financial) === null || _values$financial8 === void 0 ? void 0 : _values$financial8.receives_nfe) : null,\n        simpleClient: ((_values$financial9 = values.financial) === null || _values$financial9 === void 0 ? void 0 : _values$financial9.simpleClient) !== undefined ? !!((_values$financial10 = values.financial) === null || _values$financial10 === void 0 ? void 0 : _values$financial10.simpleClient) : null,\n        receivesSciInformation: ((_values$financial11 = values.financial) === null || _values$financial11 === void 0 ? void 0 : _values$financial11.receivesSciInformation) !== undefined ? !!((_values$financial12 = values.financial) === null || _values$financial12 === void 0 ? void 0 : _values$financial12.receivesSciInformation) : null,\n        standardIncome: (_values$financial13 = values.financial) === null || _values$financial13 === void 0 ? void 0 : _values$financial13.standardIncome,\n        carrier: (_values$financial14 = values.financial) === null || _values$financial14 === void 0 ? void 0 : _values$financial14.carrier,\n        bankInstruction: (_values$financial15 = values.financial) === null || _values$financial15 === void 0 ? void 0 : _values$financial15.bankInstruction\n      },\n      cadastralCheck: {\n        cadastralCheck: (_values$cadastralChec = values.cadastralCheck) === null || _values$cadastralChec === void 0 ? void 0 : _values$cadastralChec.cadastralCheck,\n        newClient: (_values$cadastralChec2 = values.cadastralCheck) === null || _values$cadastralChec2 === void 0 ? void 0 : _values$cadastralChec2.newClient,\n        riskClass: (_values$cadastralChec3 = values.cadastralCheck) === null || _values$cadastralChec3 === void 0 ? void 0 : _values$cadastralChec3.riskClass\n      },\n      parametrization: {\n        clientGroupCode: ((_values$parametrizati = values.parametrization) === null || _values$parametrizati === void 0 ? void 0 : _values$parametrizati.clientGroupCode) ? Number((_values$parametrizati2 = values.parametrization) === null || _values$parametrizati2 === void 0 ? void 0 : _values$parametrizati2.clientGroupCode) : null,\n        shortName: (_values$parametrizati3 = values.parametrization) === null || _values$parametrizati3 === void 0 ? void 0 : _values$parametrizati3.shortName,\n        parentCompanyCode: null,\n        // TODO: NecessÃ¡rio validar com a Dani o funcionamento\n        parentCompany: (_values$parametrizati4 = values.parametrization) === null || _values$parametrizati4 === void 0 ? void 0 : _values$parametrizati4.parentCompany,\n        historic: (_values$parametrizati5 = values.parametrization) === null || _values$parametrizati5 === void 0 ? void 0 : _values$parametrizati5.historic,\n        intermediary: ((_values$parametrizati6 = values.parametrization) === null || _values$parametrizati6 === void 0 ? void 0 : _values$parametrizati6.intermediary) !== undefined ? !!((_values$parametrizati7 = values.parametrization) === null || _values$parametrizati7 === void 0 ? void 0 : _values$parametrizati7.intermediary) : null\n      },\n      priceList: {\n        establishment128CdEsCode: values === null || values === void 0 ? void 0 : (_values$priceList = values.priceList) === null || _values$priceList === void 0 ? void 0 : (_values$priceList$est = _values$priceList.establishment128CdEsCode) === null || _values$priceList$est === void 0 ? void 0 : _values$priceList$est.codePriceList,\n        establishment22Code: values === null || values === void 0 ? void 0 : (_values$priceList2 = values.priceList) === null || _values$priceList2 === void 0 ? void 0 : (_values$priceList2$es = _values$priceList2.establishment22Code) === null || _values$priceList2$es === void 0 ? void 0 : _values$priceList2$es.codePriceList,\n        establishment15Code: values === null || values === void 0 ? void 0 : (_values$priceList3 = values.priceList) === null || _values$priceList3 === void 0 ? void 0 : (_values$priceList3$es = _values$priceList3.establishment15Code) === null || _values$priceList3$es === void 0 ? void 0 : _values$priceList3$es.codePriceList,\n        establishment31ManausCode: values === null || values === void 0 ? void 0 : (_values$priceList4 = values.priceList) === null || _values$priceList4 === void 0 ? void 0 : (_values$priceList4$es = _values$priceList4.establishment31ManausCode) === null || _values$priceList4$es === void 0 ? void 0 : _values$priceList4$es.codePriceList,\n        establishment31AgScCode: values === null || values === void 0 ? void 0 : (_values$priceList5 = values.priceList) === null || _values$priceList5 === void 0 ? void 0 : (_values$priceList5$es = _values$priceList5.establishment31AgScCode) === null || _values$priceList5$es === void 0 ? void 0 : _values$priceList5$es.codePriceList,\n        establishment31AgSpCode: values === null || values === void 0 ? void 0 : (_values$priceList6 = values.priceList) === null || _values$priceList6 === void 0 ? void 0 : (_values$priceList6$es = _values$priceList6.establishment31AgSpCode) === null || _values$priceList6$es === void 0 ? void 0 : _values$priceList6$es.codePriceList,\n        establishment305CdPe: values === null || values === void 0 ? void 0 : (_values$priceList7 = values.priceList) === null || _values$priceList7 === void 0 ? void 0 : (_values$priceList7$es = _values$priceList7.establishment305CdPe) === null || _values$priceList7$es === void 0 ? void 0 : _values$priceList7$es.codePriceList\n      },\n      registrationInformation: {\n        representativeCode: (_values$responsibleCo = values.responsibleCode) === null || _values$responsibleCo === void 0 ? void 0 : _values$responsibleCo.code,\n        representativeName: (_values$responsibleNa = values.responsibleName) === null || _values$responsibleNa === void 0 ? void 0 : _values$responsibleNa.name\n      },\n      fiscalParametrization: { ...(values.fiscalParametrization || {}),\n        expirationDate: ((_values$fiscalParamet = values.fiscalParametrization) === null || _values$fiscalParamet === void 0 ? void 0 : _values$fiscalParamet.expirationDate) && moment((_values$fiscalParamet2 = values.fiscalParametrization) === null || _values$fiscalParamet2 === void 0 ? void 0 : _values$fiscalParamet2.expirationDate, dateBackFormat).isValid() ? formatBackDateToIsoFormat(values.fiscalParametrization.expirationDate, 0) : null\n      },\n      fiscalInformation: { ...values.fiscalInformation,\n        taxRegime: values.fiscalInformation.taxRegime !== '0' ? values.fiscalInformation.taxRegime : null\n      }\n    };\n  }, [customerFromApi]);\n  const handleSaveSubmit = useCallback(async () => {\n    setSaveLoader(true);\n    const values = formRef.current.getData();\n    dispatch(CustomerActions.saveCustomerPreRegistry(formatPayload(values), customerFromApi, () => {\n      setSaveLoader(false);\n      history.push(routes.customers.path);\n    }, error => {\n      setSaveLoader(false);\n      formRef.current.setSubmitError(error);\n    }));\n  }, [customerFromApi, dispatch, formatPayload, history, routes.customers.path]);\n  const handleFinishSubmit = useCallback(values => {\n    setConcludeLoader(true);\n    dispatch(CustomerActions.finishCustomerPreRegistry(formatPayload(values), customerFromApi, () => {\n      setConcludeLoader(false);\n      history.push(routes.customers.path);\n    }, error => {\n      setConcludeLoader(false);\n      formRef.current.setSubmitError(error);\n    }));\n  }, [customerFromApi, dispatch, formatPayload, history, routes.customers.path]);\n  useFormEffect(() => {\n    if (!isEmpty(customerFromApi)) {\n      var _customerFromApi$fisc, _customerFromApi$fisc2, _customerFromApi$regi, _customerFromApi$regi2, _customerFromApi$regi3, _customerFromApi$regi4, _customerFromApi$regi5, _customerFromApi$regi6, _customerFromApi$pric, _customerFromApi$pric2, _customerFromApi$pric3, _customerFromApi$pric4, _customerFromApi$pric5, _customerFromApi$pric6, _customerFromApi$pric7, _customerFromApi$pric8;\n\n      formRef.current.setData({ ...customerFromApi,\n        parentCompanyName: {\n          companyName: customerFromApi === null || customerFromApi === void 0 ? void 0 : customerFromApi.parentCompanyName,\n          cnpj: customerFromApi === null || customerFromApi === void 0 ? void 0 : customerFromApi.parentCompanyCnpj\n        },\n        fiscalParametrizationCfop: getFormFiscalParametrizationCfop(customerFromApi),\n        fiscalParametrization: { ...customerFromApi.fiscalParametrization,\n          expirationDate: ((_customerFromApi$fisc = customerFromApi.fiscalParametrization) === null || _customerFromApi$fisc === void 0 ? void 0 : _customerFromApi$fisc.expirationDate) ? formatBackDateTimeToBackDateFormat((_customerFromApi$fisc2 = customerFromApi.fiscalParametrization) === null || _customerFromApi$fisc2 === void 0 ? void 0 : _customerFromApi$fisc2.expirationDate) : ''\n        },\n        responsibleCode: {\n          id: customerFromApi === null || customerFromApi === void 0 ? void 0 : (_customerFromApi$regi = customerFromApi.registrationInformation) === null || _customerFromApi$regi === void 0 ? void 0 : _customerFromApi$regi.id,\n          code: customerFromApi === null || customerFromApi === void 0 ? void 0 : (_customerFromApi$regi2 = customerFromApi.registrationInformation) === null || _customerFromApi$regi2 === void 0 ? void 0 : _customerFromApi$regi2.representativeCode,\n          name: customerFromApi === null || customerFromApi === void 0 ? void 0 : (_customerFromApi$regi3 = customerFromApi.registrationInformation) === null || _customerFromApi$regi3 === void 0 ? void 0 : _customerFromApi$regi3.representativeName\n        },\n        responsibleName: {\n          id: customerFromApi === null || customerFromApi === void 0 ? void 0 : (_customerFromApi$regi4 = customerFromApi.registrationInformation) === null || _customerFromApi$regi4 === void 0 ? void 0 : _customerFromApi$regi4.id,\n          code: customerFromApi === null || customerFromApi === void 0 ? void 0 : (_customerFromApi$regi5 = customerFromApi.registrationInformation) === null || _customerFromApi$regi5 === void 0 ? void 0 : _customerFromApi$regi5.representativeCode,\n          name: customerFromApi === null || customerFromApi === void 0 ? void 0 : (_customerFromApi$regi6 = customerFromApi.registrationInformation) === null || _customerFromApi$regi6 === void 0 ? void 0 : _customerFromApi$regi6.representativeName\n        },\n        priceList: {\n          establishment15Code: {\n            codePriceList: customerFromApi === null || customerFromApi === void 0 ? void 0 : (_customerFromApi$pric = customerFromApi.priceList) === null || _customerFromApi$pric === void 0 ? void 0 : _customerFromApi$pric.establishment15Code\n          },\n          establishment22Code: {\n            codePriceList: customerFromApi === null || customerFromApi === void 0 ? void 0 : (_customerFromApi$pric2 = customerFromApi.priceList) === null || _customerFromApi$pric2 === void 0 ? void 0 : _customerFromApi$pric2.establishment22Code\n          },\n          establishment31AgScCode: {\n            codePriceList: customerFromApi === null || customerFromApi === void 0 ? void 0 : (_customerFromApi$pric3 = customerFromApi.priceList) === null || _customerFromApi$pric3 === void 0 ? void 0 : _customerFromApi$pric3.establishment31AgScCode\n          },\n          establishment31AgSpCode: {\n            codePriceList: customerFromApi === null || customerFromApi === void 0 ? void 0 : (_customerFromApi$pric4 = customerFromApi.priceList) === null || _customerFromApi$pric4 === void 0 ? void 0 : _customerFromApi$pric4.establishment31AgSpCode\n          },\n          establishment31ManausCode: {\n            codePriceList: customerFromApi === null || customerFromApi === void 0 ? void 0 : (_customerFromApi$pric5 = customerFromApi.priceList) === null || _customerFromApi$pric5 === void 0 ? void 0 : _customerFromApi$pric5.establishment31ManausCode\n          },\n          establishment128CdEsCode: {\n            codePriceList: customerFromApi === null || customerFromApi === void 0 ? void 0 : (_customerFromApi$pric6 = customerFromApi.priceList) === null || _customerFromApi$pric6 === void 0 ? void 0 : _customerFromApi$pric6.establishment128CdEsCode\n          },\n          establishment305CdPe: {\n            codePriceList: customerFromApi === null || customerFromApi === void 0 ? void 0 : (_customerFromApi$pric7 = customerFromApi.priceList) === null || _customerFromApi$pric7 === void 0 ? void 0 : _customerFromApi$pric7.establishment305CdPe\n          },\n          id: customerFromApi === null || customerFromApi === void 0 ? void 0 : (_customerFromApi$pric8 = customerFromApi.priceList) === null || _customerFromApi$pric8 === void 0 ? void 0 : _customerFromApi$pric8.id\n        }\n      });\n      setStatusCustomer(customerFromApi === null || customerFromApi === void 0 ? void 0 : customerFromApi.status);\n    }\n  }, [customerFromApi]);\n  useEffect(() => {\n    if (!customerId && mode !== 'create') history.goBack();\n  }, [history, mode, customerId]);\n  return /*#__PURE__*/React.createElement(Form, {\n    ref: formRef,\n    onSubmit: handleFinishSubmit,\n    schemaConstructor: customerPreRegistrationSchema,\n    defaultValues: INITIAL_VALUES,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 5\n    }\n  }, loading && /*#__PURE__*/React.createElement(CircularLoader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 20\n    }\n  }), /*#__PURE__*/React.createElement(Tabs, {\n    tabs: tabs,\n    tabsContent: tabsContent,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    spacing: 1,\n    className: classes.buttons,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 11\n    }\n  }, mode !== 'view' ? /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    className: classes.resetBtn,\n    disabled: loading,\n    color: \"secondary\",\n    variant: \"text\",\n    onClick: () => formRef.current.reset(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 15\n    }\n  }, \"clean\") : /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    className: classes.resetBtn,\n    disabled: loading,\n    color: \"secondary\",\n    variant: \"text\",\n    onClick: () => {\n      formRef.current.reset();\n      history.push(routes.customers.path);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 15\n    }\n  }, \"back\")), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 8,\n    style: {\n      display: 'flex',\n      justifyContent: 'flex-end'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 11\n    }\n  }, mode !== 'view' ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    variant: \"outlined\",\n    color: \"secondary\",\n    disabled: loading,\n    onClick: () => history.push(routes.customers.path),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 17\n    }\n  }, \"cancel\"), /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    color: \"secondary\",\n    variant: \"contained\",\n    className: classes.btnMargin,\n    disabled: loading,\n    isLoading: saveLoader,\n    onClick: handleSaveSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 17\n    }\n  }, \"save\"), /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    color: \"secondary\",\n    variant: \"contained\",\n    className: classes.btnMargin,\n    disabled: loading,\n    isLoading: concludeLoader,\n    onClick: () => formRef.current.submit(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 382,\n      columnNumber: 17\n    }\n  }, \"finish registration\")) : /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    color: \"secondary\",\n    variant: \"contained\",\n    className: classes.btnMargin,\n    disabled: loading,\n    onClick: () => history.push(routes.editCustomerPreRegistration.path, {\n      params: {\n        mode: 'edit',\n        id: customerId\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 15\n    }\n  }, \"edit\")))));\n};\n\nexport default CustomerPreRegistrationFormScreen;","map":{"version":3,"sources":["/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/customers/screens/CustomerPreRegistrationFormScreen/CustomerPreRegistrationFormScreen.js"],"names":["React","useState","useMemo","useRef","useEffect","useCallback","useDispatch","useHistory","useLocation","moment","isEmpty","Grid","Tab","useDialog","useFormEffect","customerPreRegistrationSchema","INITIAL_VALUES","I18n","useT","customer","customerCrmRoutes","documents","documentsCrmRoutes","useCrmApi","AppActions","CustomerActions","defaultFile","formatBackDateToIsoFormat","formatBackDateTimeToBackDateFormat","dateBackFormat","trimMask","Button","Form","CircularLoader","ConfirmModal","Tabs","useRoutes","DocumentationCustomerModal","getPayloadFiscalParametrizationCfop","getFormFiscalParametrizationCfop","useStyles","Customer","Documents","Fiscal","RegistrationParameters","CustomerPreRegistrationFormScreen","t","classes","history","dispatch","routes","currentRoute","state","createDialog","formRef","saveLoader","setSaveLoader","concludeLoader","setConcludeLoader","statusCustomer","setStatusCustomer","customerId","params","id","data","customerFromApi","loading","getLoading","getOnePreRegister","replace","onErrorRetry","error","key","config","revalidate","retryCount","response","status","Component","props","onConfirm","onNegative","goBack","text","addAlert","type","message","revalidateOnFocus","documentFromApi","getOne","imagePreview","file","contentType","mode","path","newCustomerPreRegistration","editCustomerPreRegistration","disabled","tabs","howMany","handleDocumentation","tabsContent","formatPayload","values","cnpj","parentCompanyCnpj","commercialPhone","billingPhone","cellphone","shoppingPhone","stateRegistration","number","fiscalParametrizationCfop","parentCompanyName","companyName","additionalInformation","counter","counterPhone","numbersOfEmployes","Number","suggestedLimit","shareCapital","financial","issueBankSlip","undefined","gerenatesDebitNotice","calculatesFine","receives_nfe","simpleClient","receivesSciInformation","standardIncome","carrier","bankInstruction","cadastralCheck","newClient","riskClass","parametrization","clientGroupCode","shortName","parentCompanyCode","parentCompany","historic","intermediary","priceList","establishment128CdEsCode","codePriceList","establishment22Code","establishment15Code","establishment31ManausCode","establishment31AgScCode","establishment31AgSpCode","establishment305CdPe","registrationInformation","representativeCode","responsibleCode","code","representativeName","responsibleName","name","fiscalParametrization","expirationDate","isValid","fiscalInformation","taxRegime","handleSaveSubmit","current","getData","saveCustomerPreRegistry","push","customers","setSubmitError","handleFinishSubmit","finishCustomerPreRegistry","setData","buttons","resetBtn","reset","display","justifyContent","btnMargin","submit"],"mappings":";AAAA,OAAOA,KAAP,IACEC,QADF,EAEEC,OAFF,EAGEC,MAHF,EAIEC,SAJF,EAKEC,WALF,QAMO,OANP;AAOA,SAASC,WAAT,QAA4B,aAA5B;AACA,SACEC,UADF,EAEEC,WAFF,QAGO,kBAHP;AAKA,OAAOC,MAAP,MAAmB,eAAnB;AAEA,OAAOC,OAAP,MAAoB,gBAApB;AAEA,OAAOC,IAAP,MAAiB,wBAAjB;AACA,OAAOC,GAAP,MAAgB,uBAAhB;AAEA,SAASC,SAAT,QAA0B,sBAA1B;AACA,SAASC,aAAT,QAA8B,qBAA9B;AACA,OAAOC,6BAAP,IAAwCC,cAAxC,QAA8D,qEAA9D;AACA,OAAOC,IAAP,IAAeC,IAAf,QAA2B,oBAA3B;AACA,SACEC,QAAQ,IAAIC,iBADd,EAEEC,SAAS,IAAIC,kBAFf,QAGO,qDAHP;AAIA,OAAOC,SAAP,MAAsB,wCAAtB;AACA,SAASC,UAAT,QAA2B,0BAA3B;AACA,SAASC,eAAT,QAAgC,+BAAhC;AACA,OAAOC,WAAP,MAAwB,yDAAxB;AACA,SACEC,yBADF,EAEEC,kCAFF,EAGEC,cAHF,QAIO,0BAJP;AAKA,SAASC,QAAT,QAAyB,gCAAzB;AACA,OAAOC,MAAP,MAAmB,qCAAnB;AACA,OAAOC,IAAP,MAAiB,mCAAjB;AACA,SAASC,cAAT,QAA+B,qCAA/B;AACA,OAAOC,YAAP,MAAyB,iDAAzB;AACA,OAAOC,IAAP,MAAiB,mCAAjB;AACA,SAASC,SAAT,QAA0B,mDAA1B;AAEA,OAAOC,0BAAP,MAAuC,yCAAvC;AACA,SACEC,mCADF,EAEEC,gCAFF,QAGO,aAHP;AAIA,OAAOC,SAAP,MAAsB,UAAtB;AACA,OAAOC,QAAP,MAAqB,0BAArB;AACA,OAAOC,SAAP,MAAsB,4BAAtB;AACA,OAAOC,MAAP,MAAmB,sBAAnB;AACA,OAAOC,sBAAP,MAAmC,sDAAnC;;AAEA,MAAMC,iCAAiC,GAAG,MAAM;AAC9C,QAAMC,CAAC,GAAG5B,IAAI,EAAd;AACA,QAAM6B,OAAO,GAAGP,SAAS,EAAzB;AACA,QAAMQ,OAAO,GAAGzC,UAAU,EAA1B;AACA,QAAM0C,QAAQ,GAAG3C,WAAW,EAA5B;AACA,QAAM;AAAE4C,IAAAA,MAAF;AAAUC,IAAAA;AAAV,MAA2Bf,SAAS,EAA1C;AACA,QAAM;AAAEgB,IAAAA;AAAF,MAAY5C,WAAW,EAA7B;AACA,QAAM;AAAE6C,IAAAA;AAAF,MAAmBxC,SAAS,EAAlC;AAEA,QAAMyC,OAAO,GAAGnD,MAAM,CAAC,IAAD,CAAtB;AAEA,QAAM,CAACoD,UAAD,EAAaC,aAAb,IAA8BvD,QAAQ,CAAC,KAAD,CAA5C;AACA,QAAM,CAACwD,cAAD,EAAiBC,iBAAjB,IAAsCzD,QAAQ,CAAC,KAAD,CAApD;AACA,QAAM,CAAC0D,cAAD,EAAiBC,iBAAjB,IAAsC3D,QAAQ,CAAC,EAAD,CAApD;AAEA,QAAM4D,UAAU,GAAG3D,OAAO,CAAC;AAAA;;AAAA,WAAMkD,KAAN,aAAMA,KAAN,wCAAMA,KAAK,CAAEU,MAAb,kDAAM,cAAeC,EAArB;AAAA,GAAD,EAA0B,CAACX,KAAD,CAA1B,CAA1B;AAEA,QAAM;AAAEY,IAAAA,IAAI,EAAEC,eAAR;AAAyBC,IAAAA,OAAO,EAAEC;AAAlC,MAAiD5C,SAAS,CAC9DsC,UAAU,GACN,CAACzC,iBAAiB,CAACgD,iBAAlB,CAAoCC,OAApC,CAA4C,KAA5C,EAAmDR,UAAnD,CAAD,EAAiET,KAAjE,CADM,GAEN,IAH0D,EAI9D,IAJ8D,EAK9D;AACEkB,IAAAA,YAAY,CAAEC,KAAF,EAASC,GAAT,EAAcC,MAAd,EAAsBC,UAAtB,EAAkC;AAAEC,MAAAA;AAAF,KAAlC,EAAkD;AAAA;;AAC5D,UAAI,CAAAJ,KAAK,SAAL,IAAAA,KAAK,WAAL,+BAAAA,KAAK,CAAEK,QAAP,oEAAiBC,MAAjB,MAA4B,GAA5B,IAAmCF,UAAU,GAAG,CAApD,EAAuD;AACrDtB,QAAAA,YAAY,CAAC;AACXU,UAAAA,EAAE,EAAE,mBADO;AAEXe,UAAAA,SAAS,EAAE5C,YAFA;AAGX6C,UAAAA,KAAK,EAAE;AACLC,YAAAA,SAAS,GAAI;AACXN,cAAAA,UAAU,CAAC;AAAEC,gBAAAA;AAAF,eAAD,CAAV;AACD,aAHI;;AAILM,YAAAA,UAAU,GAAI;AACZjC,cAAAA,OAAO,CAACkC,MAAR;AACD,aANI;;AAOLC,YAAAA,IAAI,EAAErC,CAAC,CAAC,uBAAD;AAPF;AAHI,SAAD,CAAZ;AAaD,OAdD,MAcO;AACLG,QAAAA,QAAQ,CAACzB,UAAU,CAAC4D,QAAX,CAAoB;AAAEC,UAAAA,IAAI,EAAE,OAAR;AAAiBC,UAAAA,OAAO,EAAExC,CAAC,CAAC,oCAAD;AAA3B,SAApB,CAAD,CAAR;AACAE,QAAAA,OAAO,CAACkC,MAAR;AACD;AACF,KApBH;;AAqBEK,IAAAA,iBAAiB,EAAE;AArBrB,GAL8D,CAAhE;AA8BA,QAAM;AAAEvB,IAAAA,IAAI,EAAEwB;AAAR,MAA4BjE,SAAS,CAAC,CAAE,GAAGD,kBAAkB,CAACmE,MAAQ,+BAAhC,CAAD,CAA3C;AAEA,QAAMC,YAAY,GAAGxF,OAAO,CAAC,MAAM;AACjC,QAAI,CAACQ,OAAO,CAAC8E,eAAD,CAAZ,EAA+B;AAC7B,aAAO,EACL,GAAGA,eAAe,CAACG,IADd;AAELN,QAAAA,IAAI,EAAEG,eAAe,CAACG,IAAhB,CAAqBC;AAFtB,OAAP;AAID;;AACD,WAAOlE,WAAP;AACD,GAR2B,EAS1B,CAAC8D,eAAD,CAT0B,CAA5B;AAWA,QAAMtB,OAAO,GAAGhE,OAAO,CACrB,MAAMiE,UAAU,IAAIZ,UAAd,IAA4BE,cADb,EAErB,CAACA,cAAD,EAAiBU,UAAjB,EAA6BZ,UAA7B,CAFqB,CAAvB;AAKA,QAAMsC,IAAI,GAAG3F,OAAO,CAClB,MAAM;AAAA;;AACJ,YAAQiD,YAAY,CAAC2C,IAArB;AACE,oCAAK5C,MAAM,CAAC6C,0BAAZ,0DAAK,sBAAmCD,IAAxC;AAA+C,eAAO,QAAP;;AAC/C,oCAAK5C,MAAM,CAAC8C,2BAAZ,0DAAK,sBAAoCF,IAAzC;AAAgD,eAAO,MAAP;;AAChD;AAAS,eAAO,MAAP;AAHX;AAKD,GAPiB,EAOf,CAAC3C,YAAY,CAAC2C,IAAd,EAAoB5C,MAApB,CAPe,CAApB;AAUA,QAAM+C,QAAQ,GAAG/F,OAAO,CAAC,MAAM2F,IAAI,KAAK,MAAhB,EAAwB,CAACA,IAAD,CAAxB,CAAxB;AAEA,QAAMK,IAAI,GAAGhG,OAAO,CAClB,MAAM,cACJ,oBAAC,GAAD;AAAK,IAAA,GAAG,EAAG,CAAX;AAAe,IAAA,KAAK,EAAG4C,CAAC,CAAC,yBAAD,CAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADI,eAEJ,oBAAC,GAAD;AAAK,IAAA,GAAG,EAAG,CAAX;AAAe,IAAA,KAAK,EAAGA,CAAC,CAAC,UAAD,EAAa;AAAEqD,MAAAA,OAAO,EAAE;AAAX,KAAb,CAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFI,eAGJ,oBAAC,GAAD;AAAK,IAAA,GAAG,EAAG,CAAX;AAAe,IAAA,KAAK,EAAGrD,CAAC,CAAC,WAAD,CAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHI,eAIJ,oBAAC,GAAD;AAAK,IAAA,GAAG,EAAG,CAAX;AAAe,IAAA,KAAK,EAAGA,CAAC,CAAC,yBAAD,CAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJI,CADY,EAOlB,CAACA,CAAD,CAPkB,CAApB;AAUA,QAAMsD,mBAAmB,GAAG/F,WAAW,CACrC,MAAMgD,YAAY,CAAC;AACjBU,IAAAA,EAAE,EAAE,gBADa;AAEjBe,IAAAA,SAAS,EAAEzC,0BAFM;AAGjB0C,IAAAA,KAAK,EAAE;AAAEW,MAAAA;AAAF;AAHU,GAAD,CADmB,EAMrC,CAACrC,YAAD,EAAeqC,YAAf,CANqC,CAAvC;AASA,QAAMW,WAAW,GAAGnG,OAAO,CACzB,MAAM,cACJ,oBAAC,sBAAD;AAAwB,IAAA,GAAG,EAAG,CAA9B;AAAkC,IAAA,OAAO,EAAGoD,OAA5C;AAAsD,IAAA,QAAQ,EAAG2C,QAAjE;AAA4E,IAAA,mBAAmB,EAAGG,mBAAlG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADI,eAEJ,oBAAC,QAAD;AAAU,IAAA,GAAG,EAAG,CAAhB;AAAoB,IAAA,OAAO,EAAG9C,OAA9B;AAAwC,IAAA,QAAQ,EAAG2C,QAAnD;AAA8D,IAAA,MAAM,EAAGtC,cAAvE;AAAwF,IAAA,MAAM,EAAGkC,IAAI,KAAK,MAA1G;AAAmH,IAAA,mBAAmB,EAAGO,mBAAzI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFI,eAGJ,oBAAC,SAAD;AAAW,IAAA,GAAG,EAAG,CAAjB;AAAqB,IAAA,OAAO,EAAG9C,OAA/B;AAAyC,IAAA,QAAQ,EAAG2C,QAApD;AAA+D,IAAA,mBAAmB,EAAGG,mBAArF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHI,eAIJ,oBAAC,MAAD;AAAQ,IAAA,GAAG,EAAG,CAAd;AAAkB,IAAA,OAAO,EAAG9C,OAA5B;AAAsC,IAAA,QAAQ,EAAG2C,QAAjD;AAA4D,IAAA,mBAAmB,EAAGG,mBAAlF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJI,CADmB,EAOzB,CAACH,QAAD,EAAWG,mBAAX,EAAgCP,IAAhC,EAAsClC,cAAtC,CAPyB,CAA3B;AAUA,QAAM2C,aAAa,GAAGjG,WAAW,CAC9BkG,MAAD;AAAA;;AAAA,WAAa,EACX,GAAGA,MADQ;AAEXxC,MAAAA,EAAE,EAAEE,eAAF,aAAEA,eAAF,uBAAEA,eAAe,CAAEF,EAFV;AAGXyC,MAAAA,IAAI,EAAE1E,QAAQ,CAACyE,MAAM,CAACC,IAAP,IAAe,EAAhB,CAHH;AAIXC,MAAAA,iBAAiB,EAAE3E,QAAQ,CAACyE,MAAM,CAACE,iBAAP,IAA4B,EAA7B,CAJhB;AAKXC,MAAAA,eAAe,EAAE5E,QAAQ,CAACyE,MAAM,CAACG,eAAP,IAA0B,EAA3B,CALd;AAMXC,MAAAA,YAAY,EAAE7E,QAAQ,CAACyE,MAAM,CAACI,YAAP,IAAuB,EAAxB,CANX;AAOXC,MAAAA,SAAS,EAAE9E,QAAQ,CAACyE,MAAM,CAACK,SAAP,IAAoB,EAArB,CAPR;AAQXC,MAAAA,aAAa,EAAE/E,QAAQ,CAACyE,MAAM,CAACM,aAAP,IAAwB,EAAzB,CARZ;AASXC,MAAAA,iBAAiB,EAAEhF,QAAQ,CAACyE,MAAM,CAACO,iBAAP,IAA4B,EAA7B,CAThB;AAUXC,MAAAA,MAAM,EAAER,MAAM,CAACQ,MAAP,IAAiB,EAVd;AAWXC,MAAAA,yBAAyB,EAAE1E,mCAAmC,CAACiE,MAAD,CAXnD;AAYXU,MAAAA,iBAAiB,EAAE,0BAAAV,MAAM,CAACU,iBAAP,gFAA0BC,WAA1B,KAAyC,EAZjD;AAaXC,MAAAA,qBAAqB,EAAE,EACrB,IAAIZ,MAAM,CAACY,qBAAP,IAAgC,EAApC,CADqB;AAErBC,QAAAA,OAAO,EAAE,EACP,IAAI,0BAAAb,MAAM,CAACY,qBAAP,gFAA8BC,OAA9B,KAAyC,EAA7C,CADO;AAEPC,UAAAA,YAAY,EAAEvF,QAAQ,CAAC,CAAAyE,MAAM,SAAN,IAAAA,MAAM,WAAN,sCAAAA,MAAM,CAAEY,qBAAR,4GAA+BC,OAA/B,kFAAwCC,YAAxC,KAAwD,EAAzD;AAFf,SAFY;AAMrBC,QAAAA,iBAAiB,EAAE,2BAAAf,MAAM,CAACY,qBAAP,kFAA8BG,iBAA9B,IAAkDC,MAAM,CAAChB,MAAM,CAACY,qBAAP,CAA6BG,iBAA9B,CAAxD,GAA2G,IANzG;AAOrBE,QAAAA,cAAc,EAAE,2BAAAjB,MAAM,CAACY,qBAAP,kFAA8BK,cAA9B,IAA+CD,MAAM,CAAChB,MAAM,CAACY,qBAAP,CAA6BK,cAA9B,CAArD,GAAqG,IAPhG;AAQrBC,QAAAA,YAAY,EAAE,2BAAAlB,MAAM,CAACY,qBAAP,kFAA8BM,YAA9B,IAA6CF,MAAM,CAAChB,MAAM,CAACY,qBAAP,CAA6BM,YAA9B,CAAnD,GAAiG;AAR1F,OAbZ;AAuBXC,MAAAA,SAAS,EAAE;AACTC,QAAAA,aAAa,EAAE,sBAAApB,MAAM,CAACmB,SAAP,wEAAkBC,aAAlB,MAAoCC,SAApC,GAAgD,CAAC,wBAACrB,MAAM,CAACmB,SAAR,uDAAC,mBAAkBC,aAAnB,CAAjD,GAAoF,IAD1F;AAETE,QAAAA,oBAAoB,EAAE,uBAAAtB,MAAM,CAACmB,SAAP,0EAAkBG,oBAAlB,MAA2CD,SAA3C,GAAuD,CAAC,wBAACrB,MAAM,CAACmB,SAAR,uDAAC,mBAAkBG,oBAAnB,CAAxD,GAAkG,IAF/G;AAGTC,QAAAA,cAAc,EAAE,uBAAAvB,MAAM,CAACmB,SAAP,0EAAkBI,cAAlB,MAAqCF,SAArC,GAAiD,CAAC,wBAACrB,MAAM,CAACmB,SAAR,uDAAC,mBAAkBI,cAAnB,CAAlD,GAAsF,IAH7F;AAITC,QAAAA,YAAY,EAAE,uBAAAxB,MAAM,CAACmB,SAAP,0EAAkBK,YAAlB,MAAmCH,SAAnC,GAA+C,CAAC,wBAACrB,MAAM,CAACmB,SAAR,uDAAC,mBAAkBK,YAAnB,CAAhD,GAAkF,IAJvF;AAKTC,QAAAA,YAAY,EAAE,uBAAAzB,MAAM,CAACmB,SAAP,0EAAkBM,YAAlB,MAAmCJ,SAAnC,GAA+C,CAAC,yBAACrB,MAAM,CAACmB,SAAR,wDAAC,oBAAkBM,YAAnB,CAAhD,GAAkF,IALvF;AAMTC,QAAAA,sBAAsB,EAAE,wBAAA1B,MAAM,CAACmB,SAAP,4EAAkBO,sBAAlB,MAA6CL,SAA7C,GAAyD,CAAC,yBAACrB,MAAM,CAACmB,SAAR,wDAAC,oBAAkBO,sBAAnB,CAA1D,GAAsG,IANrH;AAOTC,QAAAA,cAAc,yBAAE3B,MAAM,CAACmB,SAAT,wDAAE,oBAAkBQ,cAPzB;AAQTC,QAAAA,OAAO,yBAAE5B,MAAM,CAACmB,SAAT,wDAAE,oBAAkBS,OARlB;AASTC,QAAAA,eAAe,yBAAE7B,MAAM,CAACmB,SAAT,wDAAE,oBAAkBU;AAT1B,OAvBA;AAkCXC,MAAAA,cAAc,EAAE;AACdA,QAAAA,cAAc,2BAAE9B,MAAM,CAAC8B,cAAT,0DAAE,sBAAuBA,cADzB;AAEdC,QAAAA,SAAS,4BAAE/B,MAAM,CAAC8B,cAAT,2DAAE,uBAAuBC,SAFpB;AAGdC,QAAAA,SAAS,4BAAEhC,MAAM,CAAC8B,cAAT,2DAAE,uBAAuBE;AAHpB,OAlCL;AAuCXC,MAAAA,eAAe,EAAE;AACfC,QAAAA,eAAe,EAAE,0BAAAlC,MAAM,CAACiC,eAAP,gFAAwBC,eAAxB,IAA0ClB,MAAM,2BAAChB,MAAM,CAACiC,eAAR,2DAAC,uBAAwBC,eAAzB,CAAhD,GAA4F,IAD9F;AAEfC,QAAAA,SAAS,4BAAEnC,MAAM,CAACiC,eAAT,2DAAE,uBAAwBE,SAFpB;AAGfC,QAAAA,iBAAiB,EAAE,IAHJ;AAGU;AACzBC,QAAAA,aAAa,4BAAErC,MAAM,CAACiC,eAAT,2DAAE,uBAAwBI,aAJxB;AAKfC,QAAAA,QAAQ,4BAAEtC,MAAM,CAACiC,eAAT,2DAAE,uBAAwBK,QALnB;AAMfC,QAAAA,YAAY,EAAE,2BAAAvC,MAAM,CAACiC,eAAP,kFAAwBM,YAAxB,MAAyClB,SAAzC,GAAqD,CAAC,4BAACrB,MAAM,CAACiC,eAAR,2DAAC,uBAAwBM,YAAzB,CAAtD,GAA8F;AAN7F,OAvCN;AA+CXC,MAAAA,SAAS,EAAE;AACTC,QAAAA,wBAAwB,EAAEzC,MAAF,aAAEA,MAAF,4CAAEA,MAAM,CAAEwC,SAAV,+EAAE,kBAAmBC,wBAArB,0DAAE,sBAA6CC,aAD9D;AAETC,QAAAA,mBAAmB,EAAE3C,MAAF,aAAEA,MAAF,6CAAEA,MAAM,CAAEwC,SAAV,gFAAE,mBAAmBG,mBAArB,0DAAE,sBAAwCD,aAFpD;AAGTE,QAAAA,mBAAmB,EAAE5C,MAAF,aAAEA,MAAF,6CAAEA,MAAM,CAAEwC,SAAV,gFAAE,mBAAmBI,mBAArB,0DAAE,sBAAwCF,aAHpD;AAITG,QAAAA,yBAAyB,EAAE7C,MAAF,aAAEA,MAAF,6CAAEA,MAAM,CAAEwC,SAAV,gFAAE,mBAAmBK,yBAArB,0DAAE,sBAA8CH,aAJhE;AAKTI,QAAAA,uBAAuB,EAAE9C,MAAF,aAAEA,MAAF,6CAAEA,MAAM,CAAEwC,SAAV,gFAAE,mBAAmBM,uBAArB,0DAAE,sBAA4CJ,aAL5D;AAMTK,QAAAA,uBAAuB,EAAE/C,MAAF,aAAEA,MAAF,6CAAEA,MAAM,CAAEwC,SAAV,gFAAE,mBAAmBO,uBAArB,0DAAE,sBAA4CL,aAN5D;AAOTM,QAAAA,oBAAoB,EAAEhD,MAAF,aAAEA,MAAF,6CAAEA,MAAM,CAAEwC,SAAV,gFAAE,mBAAmBQ,oBAArB,0DAAE,sBAAyCN;AAPtD,OA/CA;AAwDXO,MAAAA,uBAAuB,EAAE;AACvBC,QAAAA,kBAAkB,2BAAElD,MAAM,CAACmD,eAAT,0DAAE,sBAAwBC,IADrB;AAEvBC,QAAAA,kBAAkB,2BAAErD,MAAM,CAACsD,eAAT,0DAAE,sBAAwBC;AAFrB,OAxDd;AA4DXC,MAAAA,qBAAqB,EAAE,EACrB,IAAIxD,MAAM,CAACwD,qBAAP,IAAgC,EAApC,CADqB;AAErBC,QAAAA,cAAc,EAAG,0BAAAzD,MAAM,CAACwD,qBAAP,gFAA8BC,cAA9B,KAAgDvJ,MAAM,2BAAC8F,MAAM,CAACwD,qBAAR,2DAAC,uBAA8BC,cAA/B,EAA+CnI,cAA/C,CAAN,CAAqEoI,OAArE,EAAjD,GACZtI,yBAAyB,CAAC4E,MAAM,CAACwD,qBAAP,CAA6BC,cAA9B,EAA8C,CAA9C,CADb,GAEZ;AAJiB,OA5DZ;AAkEXE,MAAAA,iBAAiB,EAAE,EACjB,GAAG3D,MAAM,CAAC2D,iBADO;AAEjBC,QAAAA,SAAS,EAAE5D,MAAM,CAAC2D,iBAAP,CAAyBC,SAAzB,KAAuC,GAAvC,GAA6C5D,MAAM,CAAC2D,iBAAP,CAAyBC,SAAtE,GAAkF;AAF5E;AAlER,KAAb;AAAA,GAD+B,EAwE/B,CAAClG,eAAD,CAxE+B,CAAjC;AA2EA,QAAMmG,gBAAgB,GAAG/J,WAAW,CAClC,YAAY;AACVmD,IAAAA,aAAa,CAAC,IAAD,CAAb;AAEA,UAAM+C,MAAM,GAAGjD,OAAO,CAAC+G,OAAR,CAAgBC,OAAhB,EAAf;AAEArH,IAAAA,QAAQ,CAACxB,eAAe,CAAC8I,uBAAhB,CACPjE,aAAa,CAACC,MAAD,CADN,EAEPtC,eAFO,EAGP,MAAM;AACJT,MAAAA,aAAa,CAAC,KAAD,CAAb;AACAR,MAAAA,OAAO,CAACwH,IAAR,CAAatH,MAAM,CAACuH,SAAP,CAAiB3E,IAA9B;AACD,KANM,EAONvB,KAAD,IAAW;AACTf,MAAAA,aAAa,CAAC,KAAD,CAAb;AACAF,MAAAA,OAAO,CAAC+G,OAAR,CAAgBK,cAAhB,CAA+BnG,KAA/B;AACD,KAVM,CAAD,CAAR;AAYD,GAlBiC,EAmBlC,CAACN,eAAD,EAAkBhB,QAAlB,EAA4BqD,aAA5B,EAA2CtD,OAA3C,EAAoDE,MAAM,CAACuH,SAAP,CAAiB3E,IAArE,CAnBkC,CAApC;AAsBA,QAAM6E,kBAAkB,GAAGtK,WAAW,CACnCkG,MAAD,IAAY;AACV7C,IAAAA,iBAAiB,CAAC,IAAD,CAAjB;AAEAT,IAAAA,QAAQ,CAACxB,eAAe,CAACmJ,yBAAhB,CACPtE,aAAa,CAACC,MAAD,CADN,EAEPtC,eAFO,EAGP,MAAM;AACJP,MAAAA,iBAAiB,CAAC,KAAD,CAAjB;AACAV,MAAAA,OAAO,CAACwH,IAAR,CAAatH,MAAM,CAACuH,SAAP,CAAiB3E,IAA9B;AACD,KANM,EAONvB,KAAD,IAAW;AACTb,MAAAA,iBAAiB,CAAC,KAAD,CAAjB;AACAJ,MAAAA,OAAO,CAAC+G,OAAR,CAAgBK,cAAhB,CAA+BnG,KAA/B;AACD,KAVM,CAAD,CAAR;AAYD,GAhBmC,EAiBpC,CAACN,eAAD,EAAkBhB,QAAlB,EAA4BqD,aAA5B,EAA2CtD,OAA3C,EAAoDE,MAAM,CAACuH,SAAP,CAAiB3E,IAArE,CAjBoC,CAAtC;AAoBAhF,EAAAA,aAAa,CAAC,MAAM;AAClB,QAAI,CAACJ,OAAO,CAACuD,eAAD,CAAZ,EAA+B;AAAA;;AAC7BX,MAAAA,OAAO,CAAC+G,OAAR,CAAgBQ,OAAhB,CAAwB,EACtB,GAAG5G,eADmB;AAEtBgD,QAAAA,iBAAiB,EAAE;AACjBC,UAAAA,WAAW,EAAEjD,eAAF,aAAEA,eAAF,uBAAEA,eAAe,CAAEgD,iBADb;AAEjBT,UAAAA,IAAI,EAAEvC,eAAF,aAAEA,eAAF,uBAAEA,eAAe,CAAEwC;AAFN,SAFG;AAMtBO,QAAAA,yBAAyB,EAAEzE,gCAAgC,CAAC0B,eAAD,CANrC;AAOtB8F,QAAAA,qBAAqB,EAAE,EACrB,GAAG9F,eAAe,CAAC8F,qBADE;AAErBC,UAAAA,cAAc,EAAE,0BAAA/F,eAAe,CAAC8F,qBAAhB,gFAAuCC,cAAvC,IAAwDpI,kCAAkC,2BAACqC,eAAe,CAAC8F,qBAAjB,2DAAC,uBAAuCC,cAAxC,CAA1F,GAAoJ;AAF/I,SAPD;AAWtBN,QAAAA,eAAe,EAAE;AACf3F,UAAAA,EAAE,EAAEE,eAAF,aAAEA,eAAF,gDAAEA,eAAe,CAAEuF,uBAAnB,0DAAE,sBAA0CzF,EAD/B;AAEf4F,UAAAA,IAAI,EAAE1F,eAAF,aAAEA,eAAF,iDAAEA,eAAe,CAAEuF,uBAAnB,2DAAE,uBAA0CC,kBAFjC;AAGfK,UAAAA,IAAI,EAAE7F,eAAF,aAAEA,eAAF,iDAAEA,eAAe,CAAEuF,uBAAnB,2DAAE,uBAA0CI;AAHjC,SAXK;AAgBtBC,QAAAA,eAAe,EAAE;AACf9F,UAAAA,EAAE,EAAEE,eAAF,aAAEA,eAAF,iDAAEA,eAAe,CAAEuF,uBAAnB,2DAAE,uBAA0CzF,EAD/B;AAEf4F,UAAAA,IAAI,EAAE1F,eAAF,aAAEA,eAAF,iDAAEA,eAAe,CAAEuF,uBAAnB,2DAAE,uBAA0CC,kBAFjC;AAGfK,UAAAA,IAAI,EAAE7F,eAAF,aAAEA,eAAF,iDAAEA,eAAe,CAAEuF,uBAAnB,2DAAE,uBAA0CI;AAHjC,SAhBK;AAqBtBb,QAAAA,SAAS,EAAE;AACTI,UAAAA,mBAAmB,EAAE;AAAEF,YAAAA,aAAa,EAAEhF,eAAF,aAAEA,eAAF,gDAAEA,eAAe,CAAE8E,SAAnB,0DAAE,sBAA4BI;AAA7C,WADZ;AAETD,UAAAA,mBAAmB,EAAE;AAAED,YAAAA,aAAa,EAAEhF,eAAF,aAAEA,eAAF,iDAAEA,eAAe,CAAE8E,SAAnB,2DAAE,uBAA4BG;AAA7C,WAFZ;AAGTG,UAAAA,uBAAuB,EAAE;AAAEJ,YAAAA,aAAa,EAAEhF,eAAF,aAAEA,eAAF,iDAAEA,eAAe,CAAE8E,SAAnB,2DAAE,uBAA4BM;AAA7C,WAHhB;AAITC,UAAAA,uBAAuB,EAAE;AAAEL,YAAAA,aAAa,EAAEhF,eAAF,aAAEA,eAAF,iDAAEA,eAAe,CAAE8E,SAAnB,2DAAE,uBAA4BO;AAA7C,WAJhB;AAKTF,UAAAA,yBAAyB,EAAE;AAAEH,YAAAA,aAAa,EAAEhF,eAAF,aAAEA,eAAF,iDAAEA,eAAe,CAAE8E,SAAnB,2DAAE,uBAA4BK;AAA7C,WALlB;AAMTJ,UAAAA,wBAAwB,EAAE;AAAEC,YAAAA,aAAa,EAAEhF,eAAF,aAAEA,eAAF,iDAAEA,eAAe,CAAE8E,SAAnB,2DAAE,uBAA4BC;AAA7C,WANjB;AAOTO,UAAAA,oBAAoB,EAAE;AAAEN,YAAAA,aAAa,EAAEhF,eAAF,aAAEA,eAAF,iDAAEA,eAAe,CAAE8E,SAAnB,2DAAE,uBAA4BQ;AAA7C,WAPb;AAQTxF,UAAAA,EAAE,EAAEE,eAAF,aAAEA,eAAF,iDAAEA,eAAe,CAAE8E,SAAnB,2DAAE,uBAA4BhF;AARvB;AArBW,OAAxB;AAgCAH,MAAAA,iBAAiB,CAACK,eAAD,aAACA,eAAD,uBAACA,eAAe,CAAEY,MAAlB,CAAjB;AACD;AACF,GApCY,EAoCV,CAACZ,eAAD,CApCU,CAAb;AAsCA7D,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI,CAACyD,UAAD,IAAegC,IAAI,KAAK,QAA5B,EAAsC7C,OAAO,CAACkC,MAAR;AACvC,GAFQ,EAEN,CAAClC,OAAD,EAAU6C,IAAV,EAAgBhC,UAAhB,CAFM,CAAT;AAIA,sBACE,oBAAC,IAAD;AACE,IAAA,GAAG,EAAGP,OADR;AAEE,IAAA,QAAQ,EAAGqH,kBAFb;AAGE,IAAA,iBAAiB,EAAG5J,6BAHtB;AAIE,IAAA,aAAa,EAAGC,cAJlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAMIkD,OAAO,iBAAI,oBAAC,cAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANf,eAOE,oBAAC,IAAD;AAAM,IAAA,IAAI,EAAGgC,IAAb;AAAoB,IAAA,WAAW,EAAGG,WAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,IAAD;AAAM,IAAA,SAAS,MAAf;AAAgB,IAAA,OAAO,EAAG,CAA1B;AAA8B,IAAA,SAAS,EAAGtD,OAAO,CAAC+H,OAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,IAAD;AAAM,IAAA,IAAI,MAAV;AAAW,IAAA,EAAE,EAAG,EAAhB;AAAqB,IAAA,EAAE,EAAG,CAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGjF,IAAI,KAAK,MAAT,gBACC,oBAAC,IAAD;AACE,IAAA,EAAE,EAAG9D,MADP;AAEE,IAAA,SAAS,EAAGgB,OAAO,CAACgI,QAFtB;AAGE,IAAA,QAAQ,EAAG7G,OAHb;AAIE,IAAA,KAAK,EAAC,WAJR;AAKE,IAAA,OAAO,EAAC,MALV;AAME,IAAA,OAAO,EAAG,MAAMZ,OAAO,CAAC+G,OAAR,CAAgBW,KAAhB,EANlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADD,gBAYC,oBAAC,IAAD;AACE,IAAA,EAAE,EAAGjJ,MADP;AAEE,IAAA,SAAS,EAAGgB,OAAO,CAACgI,QAFtB;AAGE,IAAA,QAAQ,EAAG7G,OAHb;AAIE,IAAA,KAAK,EAAC,WAJR;AAKE,IAAA,OAAO,EAAC,MALV;AAME,IAAA,OAAO,EAAG,MAAM;AACdZ,MAAAA,OAAO,CAAC+G,OAAR,CAAgBW,KAAhB;AACAhI,MAAAA,OAAO,CAACwH,IAAR,CAAatH,MAAM,CAACuH,SAAP,CAAiB3E,IAA9B;AACD,KATH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAbJ,CADF,eA6BE,oBAAC,IAAD;AAAM,IAAA,IAAI,MAAV;AAAW,IAAA,EAAE,EAAG,EAAhB;AAAqB,IAAA,EAAE,EAAG,CAA1B;AAA8B,IAAA,KAAK,EAAG;AAAEmF,MAAAA,OAAO,EAAE,MAAX;AAAmBC,MAAAA,cAAc,EAAE;AAAnC,KAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGrF,IAAI,KAAK,MAAT,gBACC,uDACE,oBAAC,IAAD;AACE,IAAA,EAAE,EAAG9D,MADP;AAEE,IAAA,OAAO,EAAC,UAFV;AAGE,IAAA,KAAK,EAAC,WAHR;AAIE,IAAA,QAAQ,EAAImC,OAJd;AAKE,IAAA,OAAO,EAAG,MAAMlB,OAAO,CAACwH,IAAR,CAAatH,MAAM,CAACuH,SAAP,CAAiB3E,IAA9B,CALlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAUE,oBAAC,IAAD;AAAM,IAAA,EAAE,EAAG/D,MAAX;AACE,IAAA,KAAK,EAAC,WADR;AAEE,IAAA,OAAO,EAAC,WAFV;AAGE,IAAA,SAAS,EAAGgB,OAAO,CAACoI,SAHtB;AAIE,IAAA,QAAQ,EAAGjH,OAJb;AAKE,IAAA,SAAS,EAAGX,UALd;AAME,IAAA,OAAO,EAAG6G,gBANZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAVF,eAoBE,oBAAC,IAAD;AAAM,IAAA,EAAE,EAAGrI,MAAX;AACE,IAAA,KAAK,EAAC,WADR;AAEE,IAAA,OAAO,EAAC,WAFV;AAGE,IAAA,SAAS,EAAGgB,OAAO,CAACoI,SAHtB;AAIE,IAAA,QAAQ,EAAGjH,OAJb;AAKE,IAAA,SAAS,EAAGT,cALd;AAME,IAAA,OAAO,EAAG,MAAMH,OAAO,CAAC+G,OAAR,CAAgBe,MAAhB,EANlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BApBF,CADD,gBAiCC,oBAAC,IAAD;AAAM,IAAA,EAAE,EAAGrJ,MAAX;AACE,IAAA,KAAK,EAAC,WADR;AAEE,IAAA,OAAO,EAAC,WAFV;AAGE,IAAA,SAAS,EAAGgB,OAAO,CAACoI,SAHtB;AAIE,IAAA,QAAQ,EAAGjH,OAJb;AAKE,IAAA,OAAO,EAAG,MAAMlB,OAAO,CAACwH,IAAR,CAAatH,MAAM,CAAC8C,2BAAP,CAAmCF,IAAhD,EAAsD;AACpEhC,MAAAA,MAAM,EAAE;AACN+B,QAAAA,IAAI,EAAE,MADA;AAEN9B,QAAAA,EAAE,EAAEF;AAFE;AAD4D,KAAtD,CALlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAlCJ,CA7BF,CADF,CAPF,CADF;AA4FD,CArWD;;AAuWA,eAAehB,iCAAf","sourcesContent":["import React, {\n  useState,\n  useMemo,\n  useRef,\n  useEffect,\n  useCallback\n} from 'react'\nimport { useDispatch } from 'react-redux'\nimport {\n  useHistory,\n  useLocation\n} from 'react-router-dom'\n\nimport moment from 'moment/moment'\n\nimport isEmpty from 'lodash/isEmpty'\n\nimport Grid from '@material-ui/core/Grid'\nimport Tab from '@material-ui/core/Tab'\n\nimport { useDialog } from '@britania-crm/dialog'\nimport { useFormEffect } from '@britania-crm/forms'\nimport customerPreRegistrationSchema, { INITIAL_VALUES } from '@britania-crm/forms/schemas/customer/customerPreRegistration.schema'\nimport I18n, { useT } from '@britania-crm/i18n'\nimport {\n  customer as customerCrmRoutes,\n  documents as documentsCrmRoutes\n} from '@britania-crm/services/apis/crmApi/resources/routes'\nimport useCrmApi from '@britania-crm/services/hooks/useCrmApi'\nimport { AppActions } from '@britania-crm/stores/app'\nimport { CustomerActions } from '@britania-crm/stores/customer'\nimport defaultFile from '@britania-crm/styles/assets/images/default_login_bg.png'\nimport {\n  formatBackDateToIsoFormat,\n  formatBackDateTimeToBackDateFormat,\n  dateBackFormat\n} from '@britania-crm/utils/date'\nimport { trimMask } from '@britania-crm/utils/formatters'\nimport Button from '@britania-crm/web-components/Button'\nimport Form from '@britania-crm/web-components/Form'\nimport { CircularLoader } from '@britania-crm/web-components/Loader'\nimport ConfirmModal from '@britania-crm/web-components/Modal/ConfirmModal'\nimport Tabs from '@britania-crm/web-components/Tabs'\nimport { useRoutes } from '@britania-crm/web-src/routes/authenticated.routes'\n\nimport DocumentationCustomerModal from '../../modals/DocumentationCustomerModal'\nimport {\n  getPayloadFiscalParametrizationCfop,\n  getFormFiscalParametrizationCfop\n} from '../../utils'\nimport useStyles from './styles'\nimport Customer from './tabs/Customer/Customer'\nimport Documents from './tabs/Documents/Documents'\nimport Fiscal from './tabs/Fiscal/Fiscal'\nimport RegistrationParameters from './tabs/RegistrationParameters/RegistrationParameters'\n\nconst CustomerPreRegistrationFormScreen = () => {\n  const t = useT()\n  const classes = useStyles()\n  const history = useHistory()\n  const dispatch = useDispatch()\n  const { routes, currentRoute } = useRoutes()\n  const { state } = useLocation()\n  const { createDialog } = useDialog()\n\n  const formRef = useRef(null)\n\n  const [saveLoader, setSaveLoader] = useState(false)\n  const [concludeLoader, setConcludeLoader] = useState(false)\n  const [statusCustomer, setStatusCustomer] = useState('')\n\n  const customerId = useMemo(() => state?.params?.id, [state])\n\n  const { data: customerFromApi, loading: getLoading } = useCrmApi(\n    customerId\n      ? [customerCrmRoutes.getOnePreRegister.replace(':id', customerId), state]\n      : null,\n    null,\n    {\n      onErrorRetry (error, key, config, revalidate, { retryCount }) {\n        if (error?.response?.status === 500 && retryCount < 5) {\n          createDialog({\n            id: 'new-request-modal',\n            Component: ConfirmModal,\n            props: {\n              onConfirm () {\n                revalidate({ retryCount })\n              },\n              onNegative () {\n                history.goBack()\n              },\n              text: t('search error customer')\n            }\n          })\n        } else {\n          dispatch(AppActions.addAlert({ type: 'error', message: t('maximum number of attempts reached') }))\n          history.goBack()\n        }\n      },\n      revalidateOnFocus: false\n    }\n  )\n\n  const { data: documentFromApi } = useCrmApi([`${ documentsCrmRoutes.getOne }/PRE_CAD_CLIENTE_DOCUMENTACAO`])\n\n  const imagePreview = useMemo(() => {\n    if (!isEmpty(documentFromApi)) {\n      return {\n        ...documentFromApi.file,\n        type: documentFromApi.file.contentType\n      }\n    }\n    return defaultFile\n  }\n  , [documentFromApi])\n\n  const loading = useMemo(\n    () => getLoading || saveLoader || concludeLoader,\n    [concludeLoader, getLoading, saveLoader]\n  )\n\n  const mode = useMemo(\n    () => {\n      switch (currentRoute.path) {\n        case routes.newCustomerPreRegistration?.path : return 'create'\n        case routes.editCustomerPreRegistration?.path : return 'edit'\n        default: return 'view'\n      }\n    }, [currentRoute.path, routes]\n  )\n\n  const disabled = useMemo(() => mode === 'view', [mode])\n\n  const tabs = useMemo(\n    () => [\n      <Tab key={ 1 } label={ t('registration parameters') }/>,\n      <Tab key={ 2 } label={ t('customer', { howMany: 1 }) }/>,\n      <Tab key={ 3 } label={ t('documents') } />,\n      <Tab key={ 4 } label={ t('fiscal parameterization') }/>\n    ],\n    [t]\n  )\n\n  const handleDocumentation = useCallback(\n    () => createDialog({\n      id: 'new-user-modal',\n      Component: DocumentationCustomerModal,\n      props: { imagePreview }\n    }),\n    [createDialog, imagePreview]\n  )\n\n  const tabsContent = useMemo(\n    () => [\n      <RegistrationParameters key={ 1 } formRef={ formRef } disabled={ disabled } handleDocumentation={ handleDocumentation } />,\n      <Customer key={ 2 } formRef={ formRef } disabled={ disabled } status={ statusCustomer } isEdit={ mode === 'edit' } handleDocumentation={ handleDocumentation }/>,\n      <Documents key={ 3 } formRef={ formRef } disabled={ disabled } handleDocumentation={ handleDocumentation } />,\n      <Fiscal key={ 4 } formRef={ formRef } disabled={ disabled } handleDocumentation={ handleDocumentation } />\n    ],\n    [disabled, handleDocumentation, mode, statusCustomer]\n  )\n\n  const formatPayload = useCallback(\n    (values) => ({\n      ...values,\n      id: customerFromApi?.id,\n      cnpj: trimMask(values.cnpj || ''),\n      parentCompanyCnpj: trimMask(values.parentCompanyCnpj || ''),\n      commercialPhone: trimMask(values.commercialPhone || ''),\n      billingPhone: trimMask(values.billingPhone || ''),\n      cellphone: trimMask(values.cellphone || ''),\n      shoppingPhone: trimMask(values.shoppingPhone || ''),\n      stateRegistration: trimMask(values.stateRegistration || ''),\n      number: values.number || '',\n      fiscalParametrizationCfop: getPayloadFiscalParametrizationCfop(values),\n      parentCompanyName: values.parentCompanyName?.companyName || '',\n      additionalInformation: {\n        ...(values.additionalInformation || {}),\n        counter: {\n          ...(values.additionalInformation?.counter || {}),\n          counterPhone: trimMask(values?.additionalInformation?.counter?.counterPhone || '')\n        },\n        numbersOfEmployes: values.additionalInformation?.numbersOfEmployes ? Number(values.additionalInformation.numbersOfEmployes) : null,\n        suggestedLimit: values.additionalInformation?.suggestedLimit ? Number(values.additionalInformation.suggestedLimit) : null,\n        shareCapital: values.additionalInformation?.shareCapital ? Number(values.additionalInformation.shareCapital) : null\n      },\n      financial: {\n        issueBankSlip: values.financial?.issueBankSlip !== undefined ? !!values.financial?.issueBankSlip : null,\n        gerenatesDebitNotice: values.financial?.gerenatesDebitNotice !== undefined ? !!values.financial?.gerenatesDebitNotice : null,\n        calculatesFine: values.financial?.calculatesFine !== undefined ? !!values.financial?.calculatesFine : null,\n        receives_nfe: values.financial?.receives_nfe !== undefined ? !!values.financial?.receives_nfe : null,\n        simpleClient: values.financial?.simpleClient !== undefined ? !!values.financial?.simpleClient : null,\n        receivesSciInformation: values.financial?.receivesSciInformation !== undefined ? !!values.financial?.receivesSciInformation : null,\n        standardIncome: values.financial?.standardIncome,\n        carrier: values.financial?.carrier,\n        bankInstruction: values.financial?.bankInstruction\n      },\n      cadastralCheck: {\n        cadastralCheck: values.cadastralCheck?.cadastralCheck,\n        newClient: values.cadastralCheck?.newClient,\n        riskClass: values.cadastralCheck?.riskClass\n      },\n      parametrization: {\n        clientGroupCode: values.parametrization?.clientGroupCode ? Number(values.parametrization?.clientGroupCode) : null,\n        shortName: values.parametrization?.shortName,\n        parentCompanyCode: null, // TODO: NecessÃ¡rio validar com a Dani o funcionamento\n        parentCompany: values.parametrization?.parentCompany,\n        historic: values.parametrization?.historic,\n        intermediary: values.parametrization?.intermediary !== undefined ? !!values.parametrization?.intermediary : null\n      },\n      priceList: {\n        establishment128CdEsCode: values?.priceList?.establishment128CdEsCode?.codePriceList,\n        establishment22Code: values?.priceList?.establishment22Code?.codePriceList,\n        establishment15Code: values?.priceList?.establishment15Code?.codePriceList,\n        establishment31ManausCode: values?.priceList?.establishment31ManausCode?.codePriceList,\n        establishment31AgScCode: values?.priceList?.establishment31AgScCode?.codePriceList,\n        establishment31AgSpCode: values?.priceList?.establishment31AgSpCode?.codePriceList,\n        establishment305CdPe: values?.priceList?.establishment305CdPe?.codePriceList\n      },\n      registrationInformation: {\n        representativeCode: values.responsibleCode?.code,\n        representativeName: values.responsibleName?.name\n      },\n      fiscalParametrization: {\n        ...(values.fiscalParametrization || {}),\n        expirationDate: (values.fiscalParametrization?.expirationDate && moment(values.fiscalParametrization?.expirationDate, dateBackFormat).isValid())\n          ? formatBackDateToIsoFormat(values.fiscalParametrization.expirationDate, 0)\n          : null\n      },\n      fiscalInformation: {\n        ...values.fiscalInformation,\n        taxRegime: values.fiscalInformation.taxRegime !== '0' ? values.fiscalInformation.taxRegime : null\n      }\n    }),\n    [customerFromApi]\n  )\n\n  const handleSaveSubmit = useCallback(\n    async () => {\n      setSaveLoader(true)\n\n      const values = formRef.current.getData()\n\n      dispatch(CustomerActions.saveCustomerPreRegistry(\n        formatPayload(values),\n        customerFromApi,\n        () => {\n          setSaveLoader(false)\n          history.push(routes.customers.path)\n        },\n        (error) => {\n          setSaveLoader(false)\n          formRef.current.setSubmitError(error)\n        }\n      ))\n    },\n    [customerFromApi, dispatch, formatPayload, history, routes.customers.path]\n  )\n\n  const handleFinishSubmit = useCallback(\n    (values) => {\n      setConcludeLoader(true)\n\n      dispatch(CustomerActions.finishCustomerPreRegistry(\n        formatPayload(values),\n        customerFromApi,\n        () => {\n          setConcludeLoader(false)\n          history.push(routes.customers.path)\n        },\n        (error) => {\n          setConcludeLoader(false)\n          formRef.current.setSubmitError(error)\n        }\n      ))\n    },\n    [customerFromApi, dispatch, formatPayload, history, routes.customers.path]\n  )\n\n  useFormEffect(() => {\n    if (!isEmpty(customerFromApi)) {\n      formRef.current.setData({\n        ...customerFromApi,\n        parentCompanyName: {\n          companyName: customerFromApi?.parentCompanyName,\n          cnpj: customerFromApi?.parentCompanyCnpj\n        },\n        fiscalParametrizationCfop: getFormFiscalParametrizationCfop(customerFromApi),\n        fiscalParametrization: {\n          ...customerFromApi.fiscalParametrization,\n          expirationDate: customerFromApi.fiscalParametrization?.expirationDate ? formatBackDateTimeToBackDateFormat(customerFromApi.fiscalParametrization?.expirationDate) : ''\n        },\n        responsibleCode: {\n          id: customerFromApi?.registrationInformation?.id,\n          code: customerFromApi?.registrationInformation?.representativeCode,\n          name: customerFromApi?.registrationInformation?.representativeName\n        },\n        responsibleName: {\n          id: customerFromApi?.registrationInformation?.id,\n          code: customerFromApi?.registrationInformation?.representativeCode,\n          name: customerFromApi?.registrationInformation?.representativeName\n        },\n        priceList: {\n          establishment15Code: { codePriceList: customerFromApi?.priceList?.establishment15Code },\n          establishment22Code: { codePriceList: customerFromApi?.priceList?.establishment22Code },\n          establishment31AgScCode: { codePriceList: customerFromApi?.priceList?.establishment31AgScCode },\n          establishment31AgSpCode: { codePriceList: customerFromApi?.priceList?.establishment31AgSpCode },\n          establishment31ManausCode: { codePriceList: customerFromApi?.priceList?.establishment31ManausCode },\n          establishment128CdEsCode: { codePriceList: customerFromApi?.priceList?.establishment128CdEsCode },\n          establishment305CdPe: { codePriceList: customerFromApi?.priceList?.establishment305CdPe },\n          id: customerFromApi?.priceList?.id\n        }\n      })\n      setStatusCustomer(customerFromApi?.status)\n    }\n  }, [customerFromApi])\n\n  useEffect(() => {\n    if (!customerId && mode !== 'create') history.goBack()\n  }, [history, mode, customerId])\n\n  return (\n    <Form\n      ref={ formRef }\n      onSubmit={ handleFinishSubmit }\n      schemaConstructor={ customerPreRegistrationSchema }\n      defaultValues={ INITIAL_VALUES }\n    >\n      { loading && <CircularLoader /> }\n      <Tabs tabs={ tabs } tabsContent={ tabsContent }>\n        <Grid container spacing={ 1 } className={ classes.buttons }>\n          <Grid item xs={ 12 } sm={ 4 } >\n            {mode !== 'view' ? (\n              <I18n\n                as={ Button }\n                className={ classes.resetBtn }\n                disabled={ loading }\n                color=\"secondary\"\n                variant=\"text\"\n                onClick={ () => formRef.current.reset() }\n              >\n                clean\n              </I18n>\n            ) : (\n              <I18n\n                as={ Button }\n                className={ classes.resetBtn }\n                disabled={ loading }\n                color=\"secondary\"\n                variant=\"text\"\n                onClick={ () => {\n                  formRef.current.reset()\n                  history.push(routes.customers.path)\n                } }\n              >\n                back\n              </I18n>\n            )}\n          </Grid>\n          <Grid item xs={ 12 } sm={ 8 } style={ { display: 'flex', justifyContent: 'flex-end' } }>\n            {mode !== 'view' ? (\n              <>\n                <I18n\n                  as={ Button }\n                  variant=\"outlined\"\n                  color=\"secondary\"\n                  disabled= { loading }\n                  onClick={ () => history.push(routes.customers.path) }\n                >\n                  cancel\n                </I18n>\n                <I18n as={ Button }\n                  color=\"secondary\"\n                  variant=\"contained\"\n                  className={ classes.btnMargin }\n                  disabled={ loading }\n                  isLoading={ saveLoader }\n                  onClick={ handleSaveSubmit }\n                >\n                  save\n                </I18n>\n                <I18n as={ Button }\n                  color=\"secondary\"\n                  variant=\"contained\"\n                  className={ classes.btnMargin }\n                  disabled={ loading }\n                  isLoading={ concludeLoader }\n                  onClick={ () => formRef.current.submit() }\n                >\n                  finish registration\n                </I18n>\n              </>\n            ) : (\n              <I18n as={ Button }\n                color=\"secondary\"\n                variant=\"contained\"\n                className={ classes.btnMargin }\n                disabled={ loading }\n                onClick={ () => history.push(routes.editCustomerPreRegistration.path, {\n                  params: {\n                    mode: 'edit',\n                    id: customerId\n                  }\n                }) }\n              >\n                edit\n              </I18n>\n            )}\n          </Grid>\n        </Grid>\n      </Tabs>\n    </Form>\n  )\n}\n\nexport default CustomerPreRegistrationFormScreen\n"]},"metadata":{},"sourceType":"module"}