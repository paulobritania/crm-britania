{"ast":null,"code":"var _jsxFileName = \"/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/fan/containers/BudgetAchievement/BudgetAchievement.js\";\nimport React, { useMemo, useCallback, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport filter from 'lodash/filter';\nimport map from 'lodash/map';\nimport Grid from '@material-ui/core/Grid';\nimport { useDialog } from '@britania-crm/dialog';\nimport { useT } from '@britania-crm/i18n';\nimport { lowerAndStartCase } from '@britania-crm/utils/formatters';\nimport DataTable from '@britania-crm/web-components/DataTable';\nimport InputHidden from '@britania-crm/web-components/InputHidden';\nimport NegotiatedFundsModal from '../../modals/NegotiatedFundsModal';\n\nconst BudgetAchievement = ({\n  isDisabled,\n  formRef,\n  slaghterReturnOptions,\n  rangeOptions,\n  calculationOptions,\n  basisOfCalculationOptions,\n  descontOptions\n}) => {\n  const t = useT();\n  const {\n    createDialog\n  } = useDialog();\n  const [negotiatedFunds, setNegotiatedFunds] = useState([]);\n  const columns = useMemo(() => [{\n    title: t('value'),\n    field: 'value',\n    render: row => `${row.value}%`\n  }, {\n    title: t('description'),\n    field: 'description',\n    render: row => lowerAndStartCase(row.description)\n  }, {\n    title: t('frequency', {\n      howMany: 1\n    }),\n    field: 'periodicity',\n    render: row => lowerAndStartCase(row.periodicity)\n  }, {\n    title: t('discount'),\n    field: 'discount',\n    render: row => lowerAndStartCase(row.discount)\n  }, {\n    title: t('basis of calculation'),\n    field: 'basisOfCalculation',\n    render: row => lowerAndStartCase(row.basisOfCalculation)\n  }, {\n    title: t('calculation basis'),\n    field: 'determinationBasis',\n    render: row => lowerAndStartCase(row.determinationBasis)\n  }, {\n    title: t('slaughter return'),\n    field: 'slaughterReturn',\n    render: row => row.slaughterReturn ? 'Sim' : 'Não'\n  }], [t]);\n  const onCreateClick = useCallback(() => createDialog({\n    id: 'add-new-negotiated-funds-modal',\n    Component: NegotiatedFundsModal,\n    props: {\n      slaghterReturnOptions,\n      rangeOptions,\n      calculationOptions,\n      basisOfCalculationOptions,\n      descontOptions,\n\n      onSubmit(values) {\n        formRef.current.setFieldValue('fan.negotiatedFunds', old => [...old, values]);\n      }\n\n    }\n  }), [basisOfCalculationOptions, calculationOptions, createDialog, descontOptions, formRef, rangeOptions, slaghterReturnOptions]);\n  const onEditClick = useCallback((event, row) => createDialog({\n    id: 'add-edit-negotiated-funds-modal',\n    Component: NegotiatedFundsModal,\n    props: {\n      slaghterReturnOptions,\n      rangeOptions,\n      calculationOptions,\n      basisOfCalculationOptions,\n      descontOptions,\n      row,\n\n      onSubmit(values) {\n        formRef.current.setFieldValue('fan.negotiatedFunds', old => map(old, item => {\n          var _item$tableData, _row$tableData;\n\n          if (((_item$tableData = item.tableData) === null || _item$tableData === void 0 ? void 0 : _item$tableData.id) === (row === null || row === void 0 ? void 0 : (_row$tableData = row.tableData) === null || _row$tableData === void 0 ? void 0 : _row$tableData.id)) {\n            return { ...values,\n              tableData: item.tableData\n            };\n          }\n\n          return item;\n        }));\n      }\n\n    }\n  }), [basisOfCalculationOptions, calculationOptions, createDialog, descontOptions, formRef, rangeOptions, slaghterReturnOptions]);\n  const onDeleteClick = useCallback((event, row) => {\n    formRef.current.setFieldValue('fan.negotiatedFunds', old => filter(old, ({\n      tableData\n    }) => {\n      var _row$tableData2;\n\n      return (tableData === null || tableData === void 0 ? void 0 : tableData.id) !== (row === null || row === void 0 ? void 0 : (_row$tableData2 = row.tableData) === null || _row$tableData2 === void 0 ? void 0 : _row$tableData2.id);\n    }));\n  }, [formRef]);\n  return /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    spacing: 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(DataTable, {\n    data: negotiatedFunds,\n    columns: columns,\n    addTitle: t('add new {this}', {\n      gender: 'male',\n      this: t('budget', {\n        howMany: 1\n      })\n    }),\n    onAddClick: !isDisabled && onCreateClick,\n    onEditClick: !isDisabled && onEditClick,\n    onDeleteClick: !isDisabled && onDeleteClick,\n    emptyMessage: t('{this} datagrid body empty data source message', {\n      this: t('budget', {\n        howMany: 2\n      })\n    }),\n    options: {\n      search: false\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(InputHidden, {\n    name: \"negotiatedFunds\",\n    showError: true,\n    onValueChange: setNegotiatedFunds,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }\n  }));\n};\n\nBudgetAchievement.propTypes = {\n  isDisabled: PropTypes.bool.isRequired,\n  formRef: PropTypes.any.isRequired,\n  slaghterReturnOptions: PropTypes.array.isRequired,\n  rangeOptions: PropTypes.array.isRequired,\n  calculationOptions: PropTypes.array.isRequired,\n  basisOfCalculationOptions: PropTypes.array.isRequired,\n  descontOptions: PropTypes.array.isRequired\n};\nBudgetAchievement.defaultProps = {};\nexport default BudgetAchievement;","map":{"version":3,"sources":["/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/fan/containers/BudgetAchievement/BudgetAchievement.js"],"names":["React","useMemo","useCallback","useState","PropTypes","filter","map","Grid","useDialog","useT","lowerAndStartCase","DataTable","InputHidden","NegotiatedFundsModal","BudgetAchievement","isDisabled","formRef","slaghterReturnOptions","rangeOptions","calculationOptions","basisOfCalculationOptions","descontOptions","t","createDialog","negotiatedFunds","setNegotiatedFunds","columns","title","field","render","row","value","description","howMany","periodicity","discount","basisOfCalculation","determinationBasis","slaughterReturn","onCreateClick","id","Component","props","onSubmit","values","current","setFieldValue","old","onEditClick","event","item","tableData","onDeleteClick","gender","this","search","propTypes","bool","isRequired","any","array","defaultProps"],"mappings":"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","sourcesContent":["import React, {\n  useMemo,\n  useCallback,\n  useState\n} from 'react'\n\nimport PropTypes from 'prop-types'\n\nimport filter from 'lodash/filter'\nimport map from 'lodash/map'\n\nimport Grid from '@material-ui/core/Grid'\n\nimport { useDialog } from '@britania-crm/dialog'\nimport { useT } from '@britania-crm/i18n'\nimport { lowerAndStartCase } from '@britania-crm/utils/formatters'\nimport DataTable from '@britania-crm/web-components/DataTable'\nimport InputHidden from '@britania-crm/web-components/InputHidden'\n\nimport NegotiatedFundsModal from '../../modals/NegotiatedFundsModal'\n\nconst BudgetAchievement = ({\n  isDisabled,\n  formRef,\n  slaghterReturnOptions,\n  rangeOptions,\n  calculationOptions,\n  basisOfCalculationOptions,\n  descontOptions\n}) => {\n  const t = useT()\n  const { createDialog } = useDialog()\n\n  const [negotiatedFunds, setNegotiatedFunds] = useState([])\n\n  const columns = useMemo(() => [\n    {\n      title: t('value'),\n      field: 'value',\n      render: (row) => `${ row.value }%`\n    },\n    {\n      title: t('description'),\n      field: 'description',\n      render: (row) => lowerAndStartCase(row.description)\n    },\n    {\n      title: t('frequency', { howMany: 1 }),\n      field: 'periodicity',\n      render: (row) => lowerAndStartCase(row.periodicity)\n    },\n    {\n      title: t('discount'),\n      field: 'discount',\n      render: (row) => lowerAndStartCase(row.discount)\n    },\n    {\n      title: t('basis of calculation'),\n      field: 'basisOfCalculation',\n      render: (row) => lowerAndStartCase(row.basisOfCalculation)\n    },\n    {\n      title: t('calculation basis'),\n      field: 'determinationBasis',\n      render: (row) => lowerAndStartCase(row.determinationBasis)\n    },\n    {\n      title: t('slaughter return'),\n      field: 'slaughterReturn',\n      render: (row) => row.slaughterReturn ? 'Sim' : 'Não'\n    }\n  ], [t])\n\n  const onCreateClick = useCallback(\n    () => createDialog({\n      id: 'add-new-negotiated-funds-modal',\n      Component: NegotiatedFundsModal,\n      props: {\n        slaghterReturnOptions,\n        rangeOptions,\n        calculationOptions,\n        basisOfCalculationOptions,\n        descontOptions,\n        onSubmit (values) {\n          formRef.current.setFieldValue('fan.negotiatedFunds', (old) => [...old, values])\n        }\n      }\n    }),\n    [basisOfCalculationOptions, calculationOptions, createDialog, descontOptions, formRef, rangeOptions, slaghterReturnOptions]\n  )\n\n  const onEditClick = useCallback(\n    (event, row) => createDialog({\n      id: 'add-edit-negotiated-funds-modal',\n      Component: NegotiatedFundsModal,\n      props: {\n        slaghterReturnOptions,\n        rangeOptions,\n        calculationOptions,\n        basisOfCalculationOptions,\n        descontOptions,\n        row,\n        onSubmit (values) {\n          formRef.current.setFieldValue('fan.negotiatedFunds',\n            (old) =>\n              map(old, (item) => {\n                if (item.tableData?.id === row?.tableData?.id) {\n                  return { ...values, tableData: item.tableData }\n                }\n                return item\n              })\n          )\n        }\n      }\n    }),\n    [basisOfCalculationOptions, calculationOptions, createDialog, descontOptions, formRef, rangeOptions, slaghterReturnOptions]\n  )\n\n  const onDeleteClick = useCallback(\n    (event, row) => {\n      formRef.current.setFieldValue('fan.negotiatedFunds', (old) => filter(old, ({ tableData }) => tableData?.id !== row?.tableData?.id))\n    },\n    [formRef]\n  )\n\n  return (\n    <Grid container spacing={ 1 }>\n      <DataTable\n        data={ negotiatedFunds }\n        columns={ columns }\n        addTitle={ t('add new {this}', {\n          gender: 'male',\n          this: t('budget', { howMany: 1 })\n        }) }\n        onAddClick={ !isDisabled && onCreateClick }\n        onEditClick={ !isDisabled && onEditClick }\n        onDeleteClick={ !isDisabled && onDeleteClick }\n        emptyMessage={ t('{this} datagrid body empty data source message', { this: t('budget', { howMany: 2 }) }) }\n        options={ { search: false } }\n      />\n      <InputHidden\n        name=\"negotiatedFunds\"\n        showError\n        onValueChange={ setNegotiatedFunds }\n      />\n    </Grid>\n  )\n}\n\nBudgetAchievement.propTypes = {\n  isDisabled: PropTypes.bool.isRequired,\n  formRef: PropTypes.any.isRequired,\n  slaghterReturnOptions: PropTypes.array.isRequired,\n  rangeOptions: PropTypes.array.isRequired,\n  calculationOptions: PropTypes.array.isRequired,\n  basisOfCalculationOptions: PropTypes.array.isRequired,\n  descontOptions: PropTypes.array.isRequired\n}\n\nBudgetAchievement.defaultProps = {}\n\nexport default BudgetAchievement\n"]},"metadata":{},"sourceType":"module"}